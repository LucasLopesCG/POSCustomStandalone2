<div class="container">
  <div class="header">
    <button (click)="backToOrder()" class="btn btn-danger">
      BACK TO ORDER
    </button>
  </div>
  <div class="left">
    <div class="total">
      <p>
        <span style="font-weight: 600">Total:</span>
        {{ totalCost | number: "1.2-2" }}
      </p>
      <p>
        <span style="font-weight: 600">Paid:</span>
        {{ paid | number: "1.2-2" }}
      </p>
      <p>
        <span style="font-weight: 600">Change:</span>
        {{ change | number: "1.2-2" }}
      </p>
    </div>
    <div class="actions">
      <button (click)="payExactAmount()">Exact Amount</button>
      <!-- <button>Paid with Card NOT IMPLEMENTED</button> -->
      <div>
        <label>Enter amount given: </label>
        <input
          type="number"
          [(ngModel)]="amountVal"
          placeholder="Enter amount..."
          (ngModelChange)="setPaid()"
        />
      </div>
    </div>
    <div class="money">
      <label>Or enter individual bills and coins given: </label>
      <div *ngFor="let money of moneyOptions">
        <button (click)="decreaseMoneyCount(money)">-</button>
        <label>{{ money.name }}: {{ money.count }}</label>
        <button (click)="increaseMoneyCount(money)">+</button>
      </div>
      <button
        (click)="submitPayment()"
        [disabled]="paid < totalCost"
        class="btn btn-success"
      >
        Submit Payment
      </button>
    </div>
  </div>
  <div class="middle"></div>
  <div class="right">
    <div
      *ngFor="let product of groupedProducts; let i = index"
      class="payment-lines"
    >
      <div
        *ngIf="
          !product.product.deductCountForCouponEntry;
          else showProductAndCouponVariant
        "
      >
        <label>{{ i + 1 }} -- </label>
        <label
          >{{ product.product.name }} ({{ product.count }}) x ${{
            product.product.price | number: "1.2-2"
          }}
          = ${{
            product.product.price * product.count | number: "1.2-2"
          }}</label
        >
      </div>
      <ng-template #showProductAndCouponVariant>
        <div *ngIf="product.count - 1 > 0">
          <label>{{ i + 1 }} -- </label>
          <label
            >{{ product.product.name }} ({{ product.count - 1 }}) x ${{
              product.product.price | number: "1.2-2"
            }}
            = ${{
              product.product.price * product.count | number: "1.2-2"
            }}</label
          >
        </div>
        <div>
          <label *ngIf="product.count - 1 > 0; else default"
            >{{ i + 1 }}B --
          </label>
          <ng-template #default>
            <label>{{ i + 1 }} -- </label>
          </ng-template>
          <label>
            {{ product.product.name }} (1) x ${{
              product.product.priceAfterCoupon | number: "1.2-2"
            }}
            = ${{ product.product.priceAfterCoupon * 1 | number: "1.2-2" }}
          </label>
        </div>
      </ng-template>
    </div>

    <div
      *ngFor="let product of refundProducts; let i = index"
      class="payment-lines"
    >
      <div>
        <label>{{ i + 1 }} -- </label>
        <label
          >REFUND: {{ product.name }} (1) x -${{
            product.price | number: "1.2-2"
          }}
          = -${{ product.price | number: "1.2-2" }}</label
        >
      </div>
    </div>
    <div *ngIf="currentOrder.guruBucksUsed && currentOrder.guruBucksUsed > 0">
      <label
        >GURU BUCKS DOLLARS OFF ORDER: ${{
          currentOrder.guruBucksUsed / 20
        }}</label
      >
    </div>

    <div>
      <label>Tax: </label><label>{{ taxAmount | number: "1.2-2" }}</label>
    </div>
    <div>
      <label>Total: {{ totalCost | number: "1.2-2" }}</label>
    </div>
  </div>
</div>
